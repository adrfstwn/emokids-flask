{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
    .card {
        display: flex;
        justify-content: center;
        align-items: center;
    }
     .card-header {
        width: 100%;
        text-align: left;
    }
    .camera-preview {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
</style>
{% endblock stylesheets %}

{% block content %}

    <!-- [ Main Content ] start -->
    <div class="pcoded-main-container">
        <div class="pcoded-wrapper">

            <div class="pcoded-content">
                <div class="pcoded-inner-content">
                    <!-- [ breadcrumb ] start -->

                    <!-- [ breadcrumb ] end -->
                    <div class="main-body">
                        <div class="page-wrapper">
                            <!-- [ Main Content ] start -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Live Kamera (*Real Time)</h5>
                                </div>
                                <div class="card-block px-0 py-3">
                                    <div class="table-responsive">
                                        <img id="video" class="camera-preview" width="900" height="400">
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    <h5>Live Pose (*Real Time)</h5>
                                </div>
                                <div class="card-block px-0 py-3">
                                    <div class="table-responsive">
                                        <img id="video2" class="camera-preview" width="600" height="400">
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <!--[ Recent Users ] start-->
                                <div class="col-xl-8 col-md-6">
                                    <div class="card Recent-Users">
                                        <div class="card-header">
                                            <h5>Riwayat Emosi Anak</h5>
                                        </div>
                                        <div class="card-block px-0 py-3">
                                            <div class="table-responsive">
                                                <table class="table table-hover">
                                                    <tbody>
                                                    <tr class="unread">
                                                        <td><img class="rounded-circle" style="width:40px;"
                                                                    src="{{ config.ASSETS_ROOT }}/images/user/avatar-1.jpg" alt="activity-user">
                                                        </td>
                                                        <td>
                                                            <h6 class="mb-1">Emosi Tantrum</h6>
                                                            <p class="m-0">Lorem Ipsum is simply…</p>
                                                        </td>
                                                        <td>
                                                            <h6 class="text-muted"><i
                                                                    class="fas fa-circle text-c-green f-10 m-r-15"></i>11
                                                                MAY 12:56</h6>
                                                        </td>
                                                        <td><a href="#!"
                                                                
                                                                href="#!" class="label theme-bg text-white f-12">Lihat</a>
                                                        </td>
                                                    </tr>
                                                    <tr class="unread">
                                                        <td><img class="rounded-circle" style="width:40px;"
                                                            src="{{ config.ASSETS_ROOT }}/images/user/avatar-1.jpg" alt="activity-user">
                                                </td>
                                                        <td>
                                                            <h6 class="mb-1">Emosi Tantrum</h6>
                                                            <p class="m-0">Lorem Ipsum is simply text of…</p>
                                                        </td>
                                                        <td>
                                                            <h6 class="text-muted"><i
                                                                    class="fas fa-circle text-c-red f-10 m-r-15"></i>11 MAY
                                                                10:35</h6>
                                                        </td>
                                                        <td><a
                                                                
                                                                href="#!" class="label theme-bg text-white f-12">Lihat</a>
                                                        </td>
                                                    </tr>
                                                    <tr class="unread">
                                                        <td><img class="rounded-circle" style="width:40px;"
                                                            src="{{ config.ASSETS_ROOT }}/images/user/avatar-1.jpg" alt="activity-user">
                                                </td>
                                                        <td>
                                                            <h6 class="mb-1">Emosi Tantrum</h6>
                                                            <p class="m-0">Lorem Ipsum is simply…</p>
                                                        </td>
                                                        <td>
                                                            <h6 class="text-muted"><i
                                                                    class="fas fa-circle text-c-green f-10 m-r-15"></i>9 MAY
                                                                17:38</h6>
                                                        </td>
                                                        <td>
                                                                <a href="#!" class="label theme-bg text-white f-12">Lihat</a>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- [ Main Content ] end -->
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- [ Main Content ] end -->            

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
    var socket = io.connect('http://' + document.domain + ':' + location.port);

    socket.on('connect', function() {
        console.log('Connected to SocketIO server');
    });

    socket.on('new_frame', function(data) {
        console.log('Received new frame data');
        document.getElementById('video').src = 'data:image/jpeg;base64,' + data.image;
        document.getElementById('video2').src = 'data:image/jpeg;base64,' + data.image;
    });

    function sendPoseData(data) {
        console.log('Sending pose data:', data);
        socket.emit('pose_data', data);
    }

    // Simulasi data pose yang akan dikirim
    const poseData = {
        timestamp: new Date(),
        pose: "pose_name",
        confidence: 0.95,
    };

    // Panggil fungsi ini setelah mendeteksi pose
    sendPoseData(poseData);

    // Socket.io event listener untuk menerima data dari server (jika diperlukan)
    socket.on('response', (data) => {
        console.log('Received response from server:', data);
    });
</script>
{% endblock javascripts %}
